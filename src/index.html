<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>AmigaPal</title>

    <link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <!--<link rel="stylesheet" href="../bower_components/font-awesome/css/font-awesome.min.css">-->
    <script type="text/javascript" src="/Users/echolevel/Sites/amiga/amigapal/node_modules/@fortawesome/fontawesome-free/js/all.js"></script>
    <link rel="stylesheet" href="../bower_components/angularjs-slider/dist/rzslider.css">
    <link rel="stylesheet" href="../bower_components/angular-bootstrap/ui-bootstrap-csp.css"></script>
    <!--<link href="css/style.css" rel="stylesheet">-->
    <style type="text/css">
      @font-face {
        font-family: protracker;
        src: url('../fonts/protracker.ttf');
      }

      html {
        height: 100%;
      }

      body {
        padding: 20px;
        /*background-color: #f5f5f4;*/
        background-color: #292c34;
        color: #a2a7b6;
        font-family: system,-apple-system,".SFNSDisplay-Regular","Helvetica Neue",Helvetica,"Segoe UI",sans-serif !important;
        font-size: 13px;
        height: 100%;
        width: 100%;
      }

      ::-webkit-scrollbar {
        background-color: #898c94;
        width: .8em
      }

      ::-webkit-scrollbar-thumb:window-inactive,
      ::-webkit-scrollbar-thumb {
              background:  #595c64
      }

      #logotext {
        font-family: protracker;
        font-size: 34px;
        text-align: center;
        padding-bottom: 20px;
        padding-top: 0px;
        text-shadow: -2px 2px #fff;
        margin-top: -20px;
      }
      .selected-item {
        /*
        box-sizing: border-box;
        border: solid 1px yellow;
        margin: 1px;*/
        box-shadow: inset 0px 0px 0px 1px orange;
      }

      input, input[type="text"], input[type="select"], input[type="button"],
      button, select, .input-group-addon, .btn {
        background-color: #595c64 !important;
        border-color: #232323 !important;
        color: #fff !important;
      }

      input:hover, select:hover, .btn:hover {
        background-color: #696c74 !important;
      }

      input[type="text"], input[type="number"], select, button, input[type="radio"], input[type="checkbox"], textarea {
      outline: none;
      box-shadow:none !important;
      }

      input[type="text"], input[type="number"], select, input[type="radio"], input[type="checkbox"], textarea {
        /*border:1px solid #ccc !important;*/
      }

      .filter-input {
        border-radius: 3px;
        border: 0px !important;
        background: #595c64;
        padding: 3px;
        padding-left: 4px !important;
        font-size: 10px;
        color: #fff;
        outline: none !important;
      }

      .mainwrap {
        margin: 0 auto;
      }

      .dropzone {
        width: 100%;
        height: 480px;
        border: dashed 8px #999;
        border-radius: 30px;
        display: table;
      }
      .dropzone .droptext {
        display: table-cell;
        text-align: center;
        vertical-align: middle;
      }

      .filelist {
        width: 100%;
        margin: 0 auto;
      }

      .btn-toolbar {
        padding-bottom: 8px;
      }

      .global-options {

      }

      .fileitem {
        padding-top: 6px;
        padding-bottom: 6px;
        min-width: 100%
      }

      .fileitem:nth-child(odd){
        /*background-color: #e8e8e8;*/
        background-color: #393c44;
      }

      .custom-slider.rzslider .rz-bar {
        background: #999;
        height: 2px;
      }
      .custom-slider.rzslider .rz-selection {
        background: #fff;
      }

      .custom-slider.rzslider .rz-pointer {
        width: 8px;
        height: 16px;
        top: auto; /* to remove the default positioning */
        bottom: 0;
        background-color: orange;
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;
      }

      .custom-slider.rzslider .rz-bubble {
        color: #fff;
      }


      .custom-slider2.rzslider .rz-pointer.rz-pointer-min {
        background-color: #fff;
      }

      .custom-slider.rzslider .rz-pointer:focus {
        outline: none;
      }

      .custom-slider.rzslider .rz-pointer:after {
        display: none;
      }

      .custom-slider.rzslider .rz-bubble {
        bottom: 14px;
      }

      .custom-slider.rzslider .rz-limit {
        font-weight: bold;
        color: #555;
      }

      .custom-slider.rzslider .rz-tick {
        width: 1px;
        height: 10px;
        margin-left: 4px;
        border-radius: 0;
        background: #999;
        top: -1px;
      }

      .custom-slider.rzslider .rz-tick.rz-selected {
        background: #555;
      }


      .custom-slider2.rzslider {
        margin-top: 14px;
      }
      .custom-slider2.rzslider .rz-bar {
        background: #999;
        height: 2px;
      }
      .custom-slider2.rzslider .rz-selection {
        background: #555;
      }

      .custom-slider2.rzslider .rz-pointer {
        width: 11px;
        height: 11px;
        top: -5px; /* to remove the default positioning */

        background-color: #333;
/*
        border-top-left-radius: 3px;
        border-top-right-radius: 3px;*/

      }

      .custom-slider2.rzslider .rz-pointer:focus {
        outline: none;
      }

      .custom-slider2.rzslider .rz-pointer:after {
        display: none;
      }

      .custom-slider2.rzslider .rz-bubble {
        bottom: 14px;
      }

      .custom-slider2.rzslider .rz-limit {
        font-weight: bold;
        color: #555;
      }

      .custom-slider2.rzslider .rz-limit, .custom-slider2.rzslider .rz-floor {
        display: none;
      }

      .custom-slider2.rzslider .rz-bubble {
        display: none;
      }

      .custom-slider2.rzslider .rz-tick {
        width: 1px;
        height: 10px;
        margin-left: 4px;
        border-radius: 0;
        background: #999;
        top: -1px;
      }

      .custom-slider2.rzslider .rz-tick.rz-selected {
        background: #555;
      }

      #page-loading {
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        font-size: 60px;
        background: #000;
        opacity: 0.5;
        z-index: 10;
      }
      .spinner {
        text-align: center;
        position: relative;
        margin: 0 auto;
        top: 50%;
      }

    </style>
  </head>
  <body ng-app="mainApp" ng-controller="MainCtrl">

    <!--
    <div id="page-loading" ng-show="loading">
      <div class="spinner"><i class="fas fa-circle-notch fa-spin"></i></div>
    </div>
    -->

    <div class="mainwrap" style="max-width: 600px" >

      <div class="row global-options">

        <div class="col-12">

        </div>

         <div class="col-7">

           <!-- WIP - change target filesize text colour if it exceeds warning limit (64/128kb)
           <div class="form-group row">

             <div class="col-5  input-group input-group-sm">
               <select class="input-group-addon custom-select" ng-model="options.filesizeWarning" style="min-width: 100%" ng-options="value as key for (key, value) in fileSizes">
               </select>
             </div>
             <label class="col-7 col-form-label">Filesize warnings</label>
           </div>
          -->

           <div class="form-group row">

             <div class="col-5  input-group input-group-sm">
               <select class="input-group-addon custom-select" ng-model="options.samplerate" style="min-width: 100%" ng-options="value as key for (key, value) in ptnotes">
               </select>
             </div>
             <label class="col-7 col-form-label">ProTracker target note</label>
           </div>

           <div class="form-group row">

             <div class="col-5 input-group input-group-sm" >
               <input class="form-control" type="number" value="0" min="0" step="1" ng-model="options.samplerate">
               <span class="input-group-addon">Hz</span>
             </div>
             <label class="col-7 col-form-label">Sample rate</label>

           </div>

            <div class="form-group row">


              <div class="col-5  input-group input-group-sm">
                <select class="input-group-addon custom-select" ng-model="options.mixdown" style="min-width: 100%" ng-options="value as key for (key, value) in mixdownTypes" ng-change="setMixdown()">
                </select>
              </div>

              <label class="col-7 col-form-label">Mono mixdown type</label>

              <!-- don't know why this exists
              <label class="col-7 offset-md-5 col-form-label">
                Disable with 'Mono'
              </label>-->
            </div>

            <div class="form-group row">
              <div class="col-4">
                <div class="form-check">
                  <label class="form-check-label" style="margin-top: 6px;">
                    <input class="form-check-input" type="checkbox" ng-model="options.lowpass_enabled">
                  </label>
                </div>
              </div>

              <label class="col-8 col-form-label">8k post-processing lowpass</label>

            </div>

            <button type="button" class="btn btn-sm btn-secondary"  ng-click="applyToAll();">
              Apply to all
            </button>


        </div>

        <div class="col-5">

          <!-- Filetype filter - why does this exist? Can't think of a compelling use-case
            <div class="form-group row">
              <div class="col-6  input-group input-group-sm">
                <input class="form-control" type="text" placeholder=".wav" ng-model="options.filterext">
              </div>
              <label class="col-6 col-form-label">
                <span ng-if="options.filterext.length > 0"><strong>{{options.filterext}}</strong> only</span>
                <span ng-if="options.filterext === '*' || options.filterext.length < 1">All files</span>
              </label>
            </div>
          -->

            <div class="form-group row">

              <div class="col-7 input-group input-group-sm">
                <input class="form-control" type="text" placeholder="e.g. /usr/local/bin/" ng-model="options.soxpath">
              </div>
              <label class="col-5 col-form-label">SoX path</label>
            </div>


            <div class="form-group row">

              <div class="col-5">
                <rzslider  class="custom-slider2" rz-slider-options="{ floor: 0, ceil: 100 }" rz-slider-model="options.playbackvolume"></rzslider>
              </div>
              <label class="col-7 col-form-label">Playback volume</label>

            </div>

            <div class="form-group row">

              <div class="col-4">
                <div class="form-check">
                  <label class="form-check-label" style="margin-top: 6px;">
                    <input class="form-check-input" type="checkbox"ng-model="options.previewSamplerate">
                  </label>
                </div>
              </div>

              <label class="col-8 col-form-label">Preview sample rate</label>


              <div class="col-4">
                <div class="form-check">
                  <label class="form-check-label" style="margin-top: 6px;">
                    <input class="form-check-input" type="checkbox" ng-model="options.preview8bit" ng-change="toggle8bit()">
                  </label>
                </div>
              </div>

              <label class="col-8 col-form-label">Preview 8bit</label>

          </div>







          <div class="form-group row">
            <div class="col-12 text-left">
              <div class="btn-group ">
                  <button type="button" class="btn btn-sm btn-secondary" ng-click="clearAll();">
                    <i class="fas fa-trash-alt"></i> Clear all
                </button>
              </div>
              &nbsp;
              <div class="btn-group ">
                  <button type="button" class="btn btn-sm btn-secondary" ng-click="convertAll();">
                    <i class="fas fa-random"></i> Convert {{files.length}}
                </button>
              </div>
              <br><br>
              <strong>STATUS: <span style="color: #7cca8f;">{{statusmsg}}</span></strong>
            </div>
          </div>


        </div>



      </div>


      <div class="row">

      </div> <!-- file list row end -->


        <div class="dropzone" ng-if="files.length <= 0">
          <div class="droptext">
            Drop files or folders here
          </div>
        </div>

        <div ng-if="files.length > 0">
          <div class="row fileitem" ng-repeat="file in files" on-finish-render="postRender()"
          ng-class="{'selected-item': selectedItem == $index}"
          scroll-if="$index == selectedItem"
          >
            <div class="col-3" ng-click="itemSelected($index)">
              <!--<audio id="audio-{{$index}}">
                <source ng-src="{{file.fullpath}}" type="audio/wav" />
              </audio>-->
              Target filename: <br><i><span ng-bind="file.targetfilename"></span></i><br>
              Target filesize: <span ng-bind="file.outputsize | number: 0"></span> bytes <br>
              <!--Target duration: <span ng-bind="file.outputduration | number: 2"></span> seconds      <br>-->
              Target duration: <span ng-bind="file.trimrange | number: 2"></span>
            </div>


            <div class="col-6" style="padding: 0 !important"  ng-click="itemSelected($index)">

              <div style="width: 325px; height: 60px;">
                <rzslider style="width: 325px;" class="custom-slider" rz-slider-model="file.trimstart" rz-slider-high="file.trimend" rz-slider-options="file.trimoptions"></rzslider>
                <canvas style="position: absolute; width: 325px; height: 60px; top: 7px; left: 0;" id="wform-canvas-{{$index}}">
                </canvas>
                <canvas style="position: absolute; width: 325px; height: 60px; top: 7px; left: 0;" id="spectrum-canvas-{{$index}}">
                </canvas>
                <canvas style="position: absolute; width: 325px; height: 60px; top: 7px; left: 0;" id="filter-canvas-{{$index}}">
                </canvas>
                <div id="playhead-{{$index}}" style="left: 0; position: absolute; z-index: 3000; background-color: #ff8800; width: 1px; height: 60px; margin-top: -47px">
                </div>
              </div>

              <div class="row">
                <div class="col-5 offset-sm-1" style="padding: 0 !important">
                  <rzslider  class="custom-slider2" rz-slider-options="{ floor: 40, ceil: 20000, logScale:true, onChange: updateGlobalEffects}" rz-slider-model="file.highpassfrequency" ></rzslider>
                </div>
                <div class="col-5 offset-sm-1" style="padding: 0 !important">
                  <rzslider  class="custom-slider2" rz-slider-options="{ floor: 40, ceil: 20000, logScale:true, onChange: updateGlobalEffects}" rz-slider-model="file.lowpassfrequency" ></rzslider>
                </div>

                <label class="col-6 col-form-label">Hi pass: <input class="filter-input" type="number" style="width: 58px; padding: 0 !important" ng-model="file.highpassfrequency" ng-change="updateGlobalEffects()"></input> hz</label>
                <label class="col-6 col-form-label">Lo pass: <input class="filter-input" type="number" style="width: 58px; padding: 0 !important" ng-model="file.lowpassfrequency" ng-change="updateGlobalEffects()"></input> hz</label>
              </div>

            </div>

            <div class="col-3 offset-md-9 text-right"  ng-click="itemSelected($index)"
                  style="padding-right: 0">

                <div style="padding-bottom: 4px;">

                  <div class="col-10 offset-sm-2  input-group input-group-sm"
                      style="padding-right: 6px; padding-bottom: 4px;">
                    <select class="input-group-addon custom-select"
                            ng-model="file.samplerate"
                            style="min-width: 100%"
                            ng-options="value as key for (key, value) in ptnotes"
                            ng-change="updateGlobalEffects()"
                            >
                    </select>
                  </div>

                  <div class="col-10 offset-sm-2 input-group input-group-sm" style="padding-right: 6px">
                    <select class="input-group-addon custom-select" ng-model="file.mixdown" style="min-width: 100%" ng-options="value as key for (key, value) in mixdownTypes"
                            ng-change="updateGlobalEffects()">
                    </select>
                  </div>

                  <div class="col-8 offset-sm-4 input-group input-group-sm" style="padding-right: 4px">

                    <input class="form-check-input" type="checkbox" ng-model="file.postLP_enabled">
                    <label class="">
                      8k post LP
                    </label>
                  </div>

                  <!--
                  <button type="button" class="btn btn-sm btn-secondary"  ng-click="playerControl($index);" style="margin-bottom: 4px">
                    <i class="fa" ng-class="{'fas fa-play': file.player.paused == true, 'fas fa-pause': file.player.paused != true}"></i>
                  </button>
                  -->

                </div>

                <div class="buttons-bottomright"
                      style="position: absolute; bottom: 0; right: 6px;">
                  <button type="button" class="btn btn-sm btn-secondary"  ng-click="removeFile($index);">
                    <i class="fas fa-trash-alt"></i>
                  </button>

                  <button type="button" class="btn btn-sm btn-secondary"  ng-click="playerControl($index);">
                    <i id="playericon-{{$index}}" class="fas fa-play"></i>
                  </button>

                  <button class="btn btn-secondary btn-sm" ng-disabled="file.processing" ng-click="processItem($index, null)"><i class="fas fa-random"></i>
                    <!--{{file.buttontext}}-->
                  </button>
                </div>

            </div>


            <div class="col-10 offset-sm-2 warning-message">
              <span style="color: orange;">
                {{file.warningmessage}}
              </span>
            </div>


          </div>
        </div>




    </div><!--mainwrap end-->



  </body>

  <!-- Insert this line above script imports  -->
  <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>

  <!-- normal script imports etc  -->
  <script
    src="https://code.jquery.com/jquery-1.12.4.min.js"
    integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
    crossorigin="anonymous">
  </script>

    <script src="../bower_components/angular/angular.min.js"></script>
  <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="../bower_components/angular-animate/angular-animate.min.js"></script>
  <script src="../bower_components/angular-touch/angular-touch.min.js"></script>
  <script src="../bower_components/angular-bootstrap/ui-bootstrap.min.js"></script>


  <script src="../bower_components/angularjs-slider/dist/rzslider.min.js"></script>
	<script src="../bower_components/electangular/electangular.js"></script>

  <!-- Insert this line after script imports -->
  <script>if (window.module) module = window.module;</script>

  <script>
      // You can also require other files to run in this process
      require('./renderer.js')
    </script>

</html>
